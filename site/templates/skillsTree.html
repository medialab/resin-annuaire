

<nav id="skills-tree__nav">
  <div class="container">

    <div class="section--title">
      <div class="container">
        <p class="title">Compétences</p>
      </div>
    </div>

  <button id="toggle-graph">
    <!-- Vue graph -->
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M7 19h-6v-11h6v11zm8-18h-6v18h6v-18zm8 11h-6v7h6v-7zm1 9h-24v2h24v-2z"/></svg>
  </button>

  <button class="toggle-all is-collapsed">
    <span class="text when-collapsed">Tout déplier</span>
    <span class="text when-expanded">Tout replier</span>
    <span class="when-collapsed">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M7.33 24l-2.83-2.829 9.339-9.175-9.339-9.167 2.83-2.829 12.17 11.996z"/></svg>
    </span>
    <span class="when-expanded">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M0 7.33l2.829-2.83 9.175 9.339 9.167-9.339 2.829 2.83-11.996 12.17z"/></svg>
    </span>
  </button>


</div>

</nav>

<div id="skills-tree" class="is-collapsed">
  <!-- <h2>Arbre de compétences</h2> -->
  <ul class="level-1 is-open">
    {% for category in categories %}
    {% set hasChildren = false %}
    {% for subcategory in subcategories %}
      {% if subcategory.path.startsWith(category.path) %}
        {% set hasChildren = true %}
      {% endif %}
    {% endfor %}

    <li class="field__container{% if hasChildren %} has-child{% endif %}" data-field="{{ category.label | lower }}">

      <div class="item field__item" data-skill-id="{{ category.skillId }}" data-field="{{ category.label | lower }}">
        <input class="item__checkbox" id="cb-{{ category.skillId }}" type="checkbox" value="{{ category.skillId }}">
        <label for="cb-{{ category.skillId }}">
          <div class="label-container">
            {% include "icons/check-mark.svg" %}
          </div>
        </label>
        <span class="name" >{{ category.label }}</span>
        <span class="count">{{ category.count }}</span>
        <button class="btn__toggle">
          <span class="when-collapsed">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M7.33 24l-2.83-2.829 9.339-9.175-9.339-9.167 2.83-2.829 12.17 11.996z"/></svg>
          </span>
          <span class="when-expanded">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M0 7.33l2.829-2.83 9.175 9.339 9.167-9.339 2.829 2.83-11.996 12.17z"/></svg>
          </span>
        </button>
      </div>

      <div class="item__graph">
        {% for i in range(category.count) %}
        <div class="block"></div>
        {% endfor %}
        <div class="info">{{ category.count }}<span class="txt"> ingénieur·es</span></div>
      </div>
    
      <ul class="level-2 is-collapsed">
        {% for subcategory in subcategories %}
        {% if subcategory.path.startsWith(category.path) %}
        {% set hasChildren = false %}
        {% for subsubcategory in subsubcategories %}
          {% if subsubcategory.path.startsWith(subcategory.path) %}
            {% set hasChildren = true %}
          {% endif %}
        {% endfor %}

        <li class="skill__container{% if hasChildren %} has-child{% endif %}">
          <div class="item skill__item" data-skill-id="{{ subcategory.skillId }}" data-field="{{ category.label | lower }}">
            <input class="item__checkbox" id="cb-{{ subcategory.skillId }}" type="checkbox" value="{{ subcategory.skillId }}">
            <label for="cb-{{ subcategory.skillId }}">
              <div class="label-container">
                {% include "icons/check-mark.svg" %}
              </div>
            </label>
            <span class="name">{{ subcategory.label }}</span>
            <span class="count">{{ subcategory.count }}</span>
            <button class="btn__toggle">
              <span class="when-collapsed">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M7.33 24l-2.83-2.829 9.339-9.175-9.339-9.167 2.83-2.829 12.17 11.996z"/></svg>
              </span>
              <span class="when-expanded">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M0 7.33l2.829-2.83 9.175 9.339 9.167-9.339 2.829 2.83-11.996 12.17z"/></svg>
              </span>
            </button>
          </div>


          <div class="item__graph">
            {% for i in range(subcategory.count) %}
            <div class="block"></div>
            {% endfor %}
            <div class="info">{{ subcategory.count }}</div>
          </div>

          <ul class="level-3 is-collapsed">
            {% for subsubcategory in subsubcategories %}
            {% if subsubcategory.path.startsWith(subcategory.path) %}
            <li class="detail__container">
              <div class="item detail__item" data-skill-id="{{ subsubcategory.skillId }}" data-field="{{ category.label | lower }}">
                <input class="item__checkbox" id="cb-{{ subsubcategory.skillId }}" type="checkbox" value="{{ subsubcategory.skillId }}">
                <label for="cb-{{ subsubcategory.skillId }}">
                  <div class="label-container">
                    {% include "icons/check-mark.svg" %}
                  </div>                </label>
                <span class="name">{{ subsubcategory.label }}</span>
                <span class="count">{{ subsubcategory.count }}</span>
                <button class="btn__toggle">
                  <span class="when-collapsed">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M7.33 24l-2.83-2.829 9.339-9.175-9.339-9.167 2.83-2.829 12.17 11.996z"/></svg>
                  </span>
                  <span class="when-expanded">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M0 7.33l2.829-2.83 9.175 9.339 9.167-9.339 2.829 2.83-11.996 12.17z"/></svg>
                  </span>
                </button>
              </div>

              <div class="item__graph">
                {% for i in range(subsubcategory.count) %}
                <div class="block"></div>
                {% endfor %}
                <div class="info">{{ subsubcategory.count }}</div>
              </div>
            </li>
            {% endif %}
            {% endfor %}
          </ul>
        </li>
        {% endif %}
        {% endfor %}
      </ul>
    </li>
    {% endfor %}
  </ul>
</div>
